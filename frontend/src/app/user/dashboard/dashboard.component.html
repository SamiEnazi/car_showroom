<div class="dashboard-container p-6 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100">
    <h2 class="text-3xl font-bold mb-4">Welcome, {{ userName }}!</h2>

    <!-- Sorting and Filtering Section -->
    <div class="mb-6 space-y-4">
        <!-- Showroom Filter -->
        <div class="flex space-x-4">
            <select [(ngModel)]="selectedShowroomId" (ngModelChange)="onShowroomFilterChange()" class="p-2 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800">
                <option [value]="null" selected disabled>All Showrooms</option>
                <option *ngFor="let showroom of showrooms" [value]="showroom.id">{{ showroom.name }}</option>
            </select>
        </div>

        <!-- Sort Options -->
        <div class="flex space-x-4">
            <select [(ngModel)]="sortBy" (ngModelChange)="loadCars()" class="p-2 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800">
                <option value="price">Price</option>
                <option value="modelYear">Year</option>
                <option value="maker">Maker</option>
            </select>
            <select [(ngModel)]="sortOrder" (ngModelChange)="loadCars()" class="p-2 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800">
                <option value="asc">Ascending</option>
                <option value="desc">Descending</option>
            </select>
        </div>

        <!-- Price Range Filter -->
        <div class="flex space-x-4">
            <input type="number" [(ngModel)]="minPrice" (ngModelChange)="loadCars()" placeholder="Min Price" class="w-1/2 p-2 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800" />
            <input type="number" [(ngModel)]="maxPrice" (ngModelChange)="loadCars()" placeholder="Max Price" class="w-1/2 p-2 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800" />
        </div>

        <!-- Reset Button -->
        <div class="flex space-x-4">
            <button (click)="resetFilters()" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                Reset Filters
            </button>
        </div>
    </div>

    <!-- Showrooms List -->
    <h3 class="text-2xl font-semibold mb-4">Showrooms</h3>
    <ul class="space-y-4">
        <li *ngFor="let showroom of showrooms" class="p-4 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800">
            <div class="flex justify-between items-center">
                <div>
                    <p class="text-lg font-semibold">{{ showroom.name }}</p>
                    <p class="text-gray-600 dark:text-gray-400">Commercial Registration: {{ showroom.commercialRegistrationNumber }}</p>
                    <p class="text-gray-600 dark:text-gray-400">Contact: {{ showroom.contactNumber }}</p>
                </div>
                <!-- Admin-specific buttons -->
                <div *ngIf="isAdmin" class="flex space-x-2">
                    <button (click)="editShowroom(showroom.id)" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600">
                        Edit
                    </button>
                    <button (click)="deleteShowroom(showroom.id)" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
                        Delete
                    </button>
                </div>
            </div>

            <!-- Cars List for the Showroom -->
            <h4 class="text-xl font-semibold mt-4 mb-2">Cars in {{ showroom.name }}</h4>
            <ul class="space-y-4">
                <li *ngFor="let car of getCarsForShowroom(showroom.id)" class="p-4 border border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-700">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-lg font-semibold">{{ car.maker }} {{ car.model }} ({{ car.modelYear }})</p>
                            <p class="text-gray-600 dark:text-gray-400">${{ car.price }}</p>
                        </div>
                        <button (click)="viewDetails(car.id)" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
                            View Details
                        </button>
                    </div>
                </li>
            </ul>
        </li>
    </ul>

    <!-- Paginator -->
    <mat-paginator [length]="totalElements" [pageSize]="size" [pageIndex]="page" (page)="onPageChange($event)" class="mt-6"></mat-paginator>

    <!-- Error Message -->
    <p *ngIf="errorMessage" class="mt-4 text-red-500">{{ errorMessage }}</p>
</div>